import { useMemo } from 'react';

export default function usePlayersState({
  players,
  playersLoading,
  playersFrom,
  playersTo,
  playersTotal,
  playersSortBy,
  playersSortDir,
  playersLimit,
  playersPage,
  playersMaxPage,
  selectedPlayerId,
  setPlayersSortBy,
  setPlayersPage,
  setPlayersSortDir,
  setPlayersLimit,
  setSelectedPlayerId,
  setSelectedPlayerFactories,
  setSelectedPlayerSkills,
  selectedPlayer,
  refreshSelectedPlayer,
  inputClass,
  realms,
  factories,
  skills,
  resources,
  playerRealmCode,
  setPlayerRealmCode,
  playerRealmActivateId,
  setPlayerRealmActivateId,
  playerFactoryId,
  setPlayerFactoryId,
  playerFactoryLevel,
  setPlayerFactoryLevel,
  playerFactoryLevelById,
  playerSkillId,
  setPlayerSkillId,
  playerSkillLevel,
  setPlayerSkillLevel,
  playerSkillLevelById,
  playerResourceId,
  setPlayerResourceId,
  playerResourceAmount,
  setPlayerResourceAmount,
  playerResourceSaving,
  handlePlayerUnlockRealm,
  handlePlayerActivateRealm,
  handlePlayerSetFactoryLevel,
  handlePlayerSetSkillLevel,
  handlePlayerAddResource,
  handlePlayerRemoveResource,
  handlePlayerSet,
  selectedPlayerResources,
  formatIntegerFull,
  formatIntegerCompact,
  playerDangerLoading,
  requestPlayerReset,
  requestPlayerDelete,
}) {
  const listProps = useMemo(
    () => ({
      players,
      playersLoading,
      playersFrom,
      playersTo,
      playersTotal,
      playersSortBy,
      playersSortDir,
      playersLimit,
      playersPage,
      playersMaxPage,
      selectedPlayerId,
  onSortByChange: (value) => {
    setPlayersSortBy(value);
    setPlayersPage(0);
  },
  onSortDirChange: (value) => {
    setPlayersSortDir(value);
    setPlayersPage(0);
  },
  onSortDirToggle: () => {
    setPlayersSortDir((p) => (p === 'ASC' ? 'DESC' : 'ASC'));
    setPlayersPage(0);
  },
      onLimitChange: (value) => {
        setPlayersLimit(Number(value));
        setPlayersPage(0);
      },
      onPrevPage: () => setPlayersPage((p) => Math.max(0, p - 1)),
      onNextPage: () => setPlayersPage((p) => Math.min(playersMaxPage, p + 1)),
      onSelectPlayer: (player) => {
        setSelectedPlayerId(player.id);
        setPlayerResourceId('');
        setPlayerResourceAmount('');
        setPlayerRealmCode('');
        setPlayerRealmActivateId('');
        setPlayerFactoryId('');
        setPlayerFactoryLevel('');
        setPlayerSkillId('');
        setPlayerSkillLevel('');
        setSelectedPlayerFactories([]);
        setSelectedPlayerSkills([]);
      },
    }),
    [
      players,
      playersLoading,
      playersFrom,
      playersTo,
      playersTotal,
      playersSortBy,
      playersSortDir,
      playersLimit,
      playersPage,
      playersMaxPage,
      selectedPlayerId,
      setPlayersSortBy,
      setPlayersPage,
      setPlayersSortDir,
      setPlayersLimit,
      setSelectedPlayerId,
      setPlayerResourceId,
      setPlayerResourceAmount,
      setPlayerRealmCode,
      setPlayerRealmActivateId,
      setPlayerFactoryId,
      setPlayerFactoryLevel,
      setPlayerSkillId,
      setPlayerSkillLevel,
      setSelectedPlayerFactories,
      setSelectedPlayerSkills,
    ]
  );

  const detailsProps = useMemo(
    () => ({
      selectedPlayerId,
      selectedPlayer,
      onBack: () => setSelectedPlayerId(null),
      refreshSelectedPlayer,
      inputClass,
      realms,
      factories,
      skills,
      resources,
      playerRealmCode,
      setPlayerRealmCode,
      playerRealmActivateId,
      setPlayerRealmActivateId,
      playerFactoryId,
      setPlayerFactoryId,
      playerFactoryLevel,
      setPlayerFactoryLevel,
      playerFactoryLevelById,
      playerSkillId,
      setPlayerSkillId,
      playerSkillLevel,
      setPlayerSkillLevel,
      playerSkillLevelById,
      playerResourceId,
      setPlayerResourceId,
      playerResourceAmount,
      setPlayerResourceAmount,
      playerResourceSaving,
      handlePlayerUnlockRealm,
      handlePlayerActivateRealm,
      handlePlayerSetFactoryLevel,
      handlePlayerSetSkillLevel,
      handlePlayerAddResource,
      handlePlayerRemoveResource,
      handlePlayerSet,
      selectedPlayerResources,
      formatIntegerFull,
      formatIntegerCompact,
      playerDangerLoading,
      requestPlayerReset,
      requestPlayerDelete,
    }),
    [
      selectedPlayerId,
      selectedPlayer,
      refreshSelectedPlayer,
      inputClass,
      realms,
      factories,
      skills,
      resources,
      playerRealmCode,
      setPlayerRealmCode,
      playerRealmActivateId,
      setPlayerRealmActivateId,
      playerFactoryId,
      setPlayerFactoryId,
      playerFactoryLevel,
      setPlayerFactoryLevel,
      playerFactoryLevelById,
      playerSkillId,
      setPlayerSkillId,
      playerSkillLevel,
      setPlayerSkillLevel,
      playerSkillLevelById,
      playerResourceId,
      setPlayerResourceId,
      playerResourceAmount,
      setPlayerResourceAmount,
      playerResourceSaving,
      handlePlayerUnlockRealm,
      handlePlayerActivateRealm,
      handlePlayerSetFactoryLevel,
      handlePlayerSetSkillLevel,
      handlePlayerAddResource,
      handlePlayerRemoveResource,
      handlePlayerSet,
      selectedPlayerResources,
      formatIntegerFull,
      formatIntegerCompact,
      playerDangerLoading,
      requestPlayerReset,
      requestPlayerDelete,
    ]
  );

  return { listProps, detailsProps };
}
